<!DOCTYPE html>
<!DOCTYPE html>
<p><html>
<head>
<title>Local Docker Development DNS</title></p>
<style>
body {
  font-family: system-ui, -apple-system;
  padding: 0 2em;
  max-width: 60em;
  margin: 10ex auto;
}

code {
  background-color: whitesmoke;
  color: darkslategrey;
  padding: 0.5ex 0.5em;
  border-radius: 0.75em;
}

code.language-console {
  padding: 2ex 1em;
  margin: 2ex 0;
  display: block;
  overflow-x: auto;
}

@media only screen and (max-width: 980px) {
  code.language-console {
    font-size: 25px;
  }
}

code.language-console::before {
  content: "$ ";
  color: black;
  font-weight: bold;
}
</style>
<p></head></p>
<body>

# Local Docker Development DNS

A systemd service that will monitor your Docker host and provide
DNS names for containers based of the container name.

If a `VIRTUAL_HOST` environment variable is present the DNS we will
base the DNS of that instead.

The service broadcasts the domain names using multicast DNS
(a.k.a. mDNS, zeroconf, bounjour, avahi).

A limitation of this is that domains name can only be on the `.local`
TLD and only have one level below the TLD. A benefit is that you don't
have to change your DNS server or configure stuff in `/etc/resolv` or
similar.

The service will rewrite hostnames in `VIRTUAL_HOST` to match
this. I.e. `my.fancy.site` will be rewritten to `my-fancy.local`.

If the containers also have exposed ports (and the ports can be looked
up in `/etc/services`) the service will also broadcast the
service/domain for service discovery (i.e. `_https._tcp.` for
https://my-fancy.local).

## Install

For Pop!_OS, Ubuntu, Debian and the like, download the `.deb` package
file from the [latest
release](https://github.com/arnested/ldddns/releases/latest) and open
it or run:


<pre><code class="language-console">sudo dpkg -i <a href="https://github.com/arnested/ldddns/releases/latest/download/ldddns_0.0.46_linux_amd64.deb">ldddns_0.0.46_linux_amd64.deb</a>
</code></pre>


Or just run the following command which will download and install the
latest package for you:


<pre><code class="language-console">curl -fsSL https://ldddns.arnested.dk/install.sh | bash
</code></pre>


For other distributions download the binary from the [latest
release](https://github.com/arnested/ldddns/releases/latest) and
create a systemd service unit file yourself based on
[`ldddns.service`](https://github.com/arnested/ldddns/blob/main/ldddns.service).

### Updates

When you install the package it will add an APT source list so you
will receive future updates to `ldddns` along with your other system
updates.

## Keeping an eye on things

You can get the status of the service by running:


<pre><code class="language-console">sudo systemctl status ldddns.service
● ldddns.service - Local Docker Development DNS
     Loaded: loaded (/lib/systemd/system/ldddns.service; enabled; vendor preset: enabled)
     Active: active (running) since Fri 2021-01-08 09:29:46 CET; 44min ago
   Main PID: 87715 (ldddns)
      Tasks: 8 (limit: 47858)
     Memory: 5.2M
     CGroup: /system.slice/ldddns.service
             └─87715 /usr/libexec/ldddns

jan 08 09:29:46 pop-os systemd[1]: Starting Local Docker Development DNS...
jan 08 09:29:46 pop-os ldddns[87715]: Starting ldddns 0.0.41...
jan 08 09:29:46 pop-os systemd[1]: Started Local Docker Development DNS.
jan 08 10:13:52 pop-os ldddns[87715]: added address for &quot;my-fancy.local&quot; pointing to &quot;172.19.0.3&quot;
</code></pre>


Or follow the log with:


<pre><code class="language-console">sudo journalctl --follow --unit ldddns.service
</code></pre>


## Bugs, thoughts, and comments

Bugs, thoughts, and comments are welcome.

You can use the [GitHub
Issues](https://github.com/arnested/ldddns/issues) and/or [GitHub
Discussions](https://github.com/arnested/ldddns/discussions).

</body>
<p></html></p>
