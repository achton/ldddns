<!DOCTYPE html>
<html lang="en">
<head>
<title>Local Docker Development DNS</title>
<meta name="description" content="A systemd service that will monitor your Docker host and provide DNS names for containers based of the container name." />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
html {
  background-color: white;
  color: black;
  font-family: system-ui, -apple-system;
  font-size: 16px;
  line-height: 1.6;
}

body {
  padding: 0 2em;
  max-width: 62em;
  margin: 10ex auto;
}

code {
  background-color: whitesmoke;
  color: darkslategrey;
  padding: 0.5ex 0.5em;
  border-radius: 0.75em;
}

code.language-console {
  padding: 2ex 1em;
  margin: 2ex 0;
  display: block;
  overflow-x: auto;
}

code.language-console::before {
  content: "$ ";
  color: black;
  font-weight: bold;
}
</style>
</head>
<body>

<h1>Local Docker Development DNS</h1>
<p>A systemd service that will monitor your Docker host and provide
DNS names for containers based of the container name.</p>
<p>If a <code>VIRTUAL_HOST</code> environment variable is present a hostname based
on that will also be set.</p>
<p>The service broadcasts the domain names using multicast DNS
(a.k.a. mDNS, zeroconf, bounjour, avahi).</p>
<p>A limitation of this is that domains name can only be on the <code>.local</code>
TLD and only have one level below the TLD. A benefit is that you don't
have to change your DNS server or configure stuff in <code>/etc/resolv</code> or
similar.</p>
<p>The service will rewrite hostnames to match this. I.e. <code>my.fancy.site</code>
will be rewritten to <code>my-fancy.local</code>.</p>
<p>If the containers also have exposed ports (and the ports can be looked
up in <code>/etc/services</code>) the service will also broadcast the
service/domain for service discovery (i.e. <code>_https._tcp.</code> for
https://my-fancy.local). It will broadcast the domain based on
<code>VIRTUAL_HOST</code> if set and otherwise the one based on the container
name.</p>
<h2>Install</h2>
<p>For Pop!_OS, Ubuntu, Debian and the like, download the <code>.deb</code> package
file from the <a href="https://github.com/arnested/ldddns/releases/latest">latest
release</a> and open
it or run:</p>
<pre><code class="language-console">sudo dpkg -i <a href="https://github.com/arnested/ldddns/releases/latest/download/ldddns_0.0.57_linux_amd64.deb">ldddns_0.0.57_linux_amd64.deb</a>
</code></pre>
<p>Or just run the following command which will download and install the
latest package for you:</p>
<pre><code class="language-console">curl -fsSL https://ldddns.arnested.dk/install.sh | bash
</code></pre>
<p>For other distributions download the binary from the <a href="https://github.com/arnested/ldddns/releases/latest">latest
release</a> and
create a systemd service unit file yourself based on
<a href="https://github.com/arnested/ldddns/blob/main/ldddns.service"><code>ldddns.service</code></a>.</p>
<h3>Updates</h3>
<p>When you install the package it will add an APT source list so you
will receive future updates to <code>ldddns</code> along with your other system
updates.</p>
<h2>Keeping an eye on things</h2>
<p>You can get the status of the service by running:</p>
<pre><code class="language-console">sudo systemctl status ldddns.service
● ldddns.service - Local Docker Development DNS
     Loaded: loaded (/lib/systemd/system/ldddns.service; enabled; vendor preset: enabled)
     Active: active (running) since Fri 2021-01-08 09:29:46 CET; 44min ago
   Main PID: 87715 (ldddns)
      Tasks: 8 (limit: 47858)
     Memory: 5.2M
     CGroup: /system.slice/ldddns.service
             └─87715 /usr/libexec/ldddns

jan 08 09:29:46 pop-os systemd[1]: Starting Local Docker Development DNS...
jan 08 09:29:46 pop-os ldddns[87715]: Starting ldddns 0.0.57...
jan 08 09:29:46 pop-os systemd[1]: Started Local Docker Development DNS.
jan 08 10:13:52 pop-os ldddns[87715]: added address for &quot;my-fancy.local&quot; pointing to &quot;172.19.0.3&quot;
jan 08 10:13:52 pop-os ldddns[87715]: added service &quot;_http._tcp&quot; pointing to &quot;my-fancy.local&quot;
</code></pre>
<p>Or follow the log with:</p>
<pre><code class="language-console">sudo journalctl --follow --unit ldddns.service
</code></pre>
<h2>Bugs, thoughts, and comments</h2>
<p>Bugs, thoughts, and comments are welcome.</p>
<p>You can use the <a href="https://github.com/arnested/ldddns/issues">GitHub
Issues</a> and/or <a href="https://github.com/arnested/ldddns/discussions">GitHub
Discussions</a>.</p>
</body>
</html>
